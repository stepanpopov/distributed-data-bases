# PostgreSQL Client Authentication Configuration File
# ===================================================

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Локальные подключения
local   all             postgres                                peer
local   all             all                                     md5

# IPv4 локальные подключения
host    all             postgres        127.0.0.1/32            md5
host    all             postgres        ::1/128                 md5

# Подключения для репликации между узлами Docker
# Пользователь репликации для логической репликации
host    hotel_management repuser        172.20.0.0/16           md5
host    replication      repuser        172.20.0.0/16           md5

# Подключения суперпользователя postgres в Docker сети
host    all             postgres        172.20.0.0/16           md5

# Подключения обычных пользователей в Docker сети
host    hotel_management all            172.20.0.0/16           md5

# Внешние подключения для администрирования
# Разрешаем подключения с хост-машины (для тестирования)
host    all             postgres        172.17.0.0/16           md5
host    hotel_management postgres       0.0.0.0/0               md5

# IPv6 подключения
host    all             all             ::1/128                 md5

# Запрещаем все остальные подключения (по умолчанию)
host    all             all             0.0.0.0/0               reject
